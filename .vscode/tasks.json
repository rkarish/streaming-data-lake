{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "reload-system",
            "type": "shell",
            "command": "docker compose down && docker compose up -d && bash scripts/setup.sh",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "start-services",
            "type": "shell",
            "command": "docker compose up -d",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "stop-services",
            "type": "shell",
            "command": "docker compose down",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "run-setup",
            "type": "shell",
            "command": "bash scripts/setup.sh",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "start-data-generator",
            "type": "shell",
            "command": "docker compose --profile generator up -d mock-data-gen",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "stop-data-generator",
            "type": "shell",
            "command": "docker compose --profile generator stop mock-data-gen",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "backfill-data-1h",
            "type": "shell",
            "command": "BACKFILL_HOURS=1 docker compose --profile generator up -d mock-data-gen",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "submit-flink-jobs",
            "type": "shell",
            "command": "docker compose exec -T flink-jobmanager bash /opt/flink/submit-sql-job.sh",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "run-table-maintenance",
            "type": "shell",
            "command": "bash scripts/maintenance.sh",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "run-query-examples",
            "type": "shell",
            "command": "bash scripts/query-examples.sh",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "view-flink-logs",
            "type": "shell",
            "command": "docker compose logs -f --tail 100 flink-jobmanager flink-taskmanager",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "view-kafka-logs",
            "type": "shell",
            "command": "docker compose logs -f --tail 100 kafka",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "view-generator-logs",
            "type": "shell",
            "command": "docker compose --profile generator logs -f --tail 100 mock-data-gen",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "tail-topic-bid-requests",
            "type": "shell",
            "command": "docker compose exec kafka /opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic bid-requests",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "tail-topic-bid-responses",
            "type": "shell",
            "command": "docker compose exec kafka /opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic bid-responses",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "tail-topic-impressions",
            "type": "shell",
            "command": "docker compose exec kafka /opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic impressions",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "tail-topic-clicks",
            "type": "shell",
            "command": "docker compose exec kafka /opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic clicks",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "list-kafka-topics",
            "type": "shell",
            "command": "docker exec kafka /opt/kafka/bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "check-service-health",
            "type": "shell",
            "command": "docker compose ps --format 'table {{.Name}}\t{{.Status}}\t{{.Ports}}'",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "superset-debug-script",
            "type": "shell",
            "command": "docker exec -e ENABLE_DEBUGGER=true -e PYTHONUNBUFFERED=1 superset python /app/setup-dashboards.py",
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": {
                "owner": "custom",
                "pattern": {
                    "regexp": "^NEVER_MATCH$"
                },
                "background": {
                    "activeOnStart": true,
                    "beginsPattern": "^.$",
                    "endsPattern": "^.*Waiting for debugger.*$"
                }
            }
        }
    ]
}